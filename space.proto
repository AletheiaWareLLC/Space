/*
 * Copyright 2019 Aletheia Ware LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

syntax = "proto3";

option go_package = "github.com/AletheiaWareLLC/spacego";
option java_outer_classname = "SpaceProto";
option java_package = "com.aletheiaware.space";
option optimize_for = LITE_RUNTIME;

package space;

import "bc.proto";
import "finance.proto";

message Meta {
    // Name of file
    string name = 1;
    // Size of file in bytes
    fixed64 size = 2;
    // MIME type of file
    string type = 3;
    // bc.Record.reference will hold the reference to the file's data and preview data
}

message StorageRequest {
    string alias = 1;
    finance.PaymentProcessor processor = 2;
    string customer_id = 3;
    string payment_id = 4;
    message Bundle {
        // The key used to encrypt the payload.
        bytes key = 1;
        // The algorithm used to encrypt the key.
        bc.EncryptionAlgorithm key_encryption_algorithm = 2;
        // The actual payload
        bytes payload = 3;
        // The algorithm used to compress the payload.
        bc.CompressionAlgorithm compression_algorithm = 4;
        // The algorithm used to encrypt the payload.
        bc.EncryptionAlgorithm encryption_algorithm = 5;
        // Signature of payload (signed by the file owner's private key).
        bytes signature = 6;
        // The algorithm used to sign the payload.
        bc.SignatureAlgorithm signature_algorithm = 7;
    }
    Bundle file = 5;
    Bundle meta = 6;
    Bundle preview = 7;
}

message StorageResponse {
    bc.Reference file = 1;
    bc.Reference meta = 2;
    bc.Reference preview = 3;
}